
drop table CHATS;
drop table MESSAGES;
drop table USERS;
drop table USERS_CHATS;


CREATE TABLE CHATS(
	chat_id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	chat_name TEXT NOT NULL
);
CREATE TABLE USERS(
	user_id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	user_name TEXT NOT NULL,
	password TEXT DEFAULT 0 NOT NULL, 
	phone TEXT DEFAULT 0
);
CREATE TABLE USERS_CHATS (
	chat_id INTEGER NOT NULL,
	user_id INTEGER NOT NULL,
	read BOOLEAN DEFAULT FALSE,
	CONSTRAINT USERS_CHATS_CHATS_FK FOREIGN KEY (chat_id) REFERENCES CHATS(chat_id) ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT USERS_CHATS_USERS_FK FOREIGN KEY (user_id) REFERENCES USERS(user_id) ON DELETE CASCADE ON UPDATE CASCADE
);
CREATE TABLE MESSAGES (
	chat_id INTEGER NOT NULL,
	message_id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
	message_number INTEGER NOT NULL,
	content TEXT,
	user_id INTEGER NOT NULL,
	datetime TEXT NOT NULL,
	CONSTRAINT MESSAGES_CHATS_FK FOREIGN KEY (chat_id) REFERENCES CHATS(chat_id) ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT MESSAGES_USERS_FK FOREIGN KEY (user_id) REFERENCES USERS(user_id) ON DELETE CASCADE ON UPDATE CASCADE
);

CREATE TABLE IMAGES (
	message_id INTEGER NOT NULL,
	image_path TEXT NOT NULL,
	CONSTRAINT MESSAGES_CHATS_FK FOREIGN KEY (message_id) REFERENCES MESSAGES (message_id) ON DELETE CASCADE ON UPDATE CASCADE
)
CREATE TABLE sqlite_sequence(name,seq);
